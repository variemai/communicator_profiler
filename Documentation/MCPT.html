<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-10-15 Fri 00:32 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MPI Communicator Profiling Tool</title>
<meta name="author" content="Ioannis Vardas" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>#+HTML_HEAD: <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>#+HTML_HEAD: <style type="text/css">
pre.src:hover:before { display: none; }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">MPI Communicator Profiling Tool</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org1f099ef">Overview</a>
<ul>
<li><a href="#org953fa4d">Specifications</a></li>
</ul>
</li>
<li><a href="#orge0b835a">Installation</a>
<ul>
<li><a href="#org687b05c">Dependencies</a></li>
<li><a href="#org7724104">Compile</a></li>
<li><a href="#orgdebac7e">Tests</a></li>
</ul>
</li>
<li><a href="#org585fb94">Usage</a>
<ul>
<li><a href="#org2ed840f">Output</a>
<ul>
<li><a href="#org66ca6c8">Header</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9714d01">Implementation</a>
<ul>
<li><a href="#org09acddf">Basic idea</a></li>
<li><a href="#orgd3c7ddb">Supported Communicator Primitives</a></li>
<li><a href="#org5d60768">Unsupported Communicator Primitives</a></li>
<li><a href="#orgd52d58f"><span class="todo TODO">TODO</span> Supported Communicator Primitives</a></li>
<li><a href="#org6e10987"><span class="done DONE">DONE</span> Supported MPI Collective communication Primitives</a></li>
<li><a href="#org11ebab3">Supported MPI Point to Point Primitives</a></li>
<li><a href="#orga9f82f3">Other MPI calls</a></li>
<li><a href="#org488eb53">Communicator creator primitives profiling</a>
<ul>
<li><a href="#org0bdd72a">Profiling MPI_Comm_create</a></li>
<li><a href="#orge018e45">Profiling MPI_Comm_split</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgdcd5bde">Contribute</a>
<ul>
<li><a href="#org638c8bc">How to add a new primitive for profiling</a></li>
</ul>
</li>
<li><a href="#orga055119">Future Work</a>
<ul>
<li><a href="#org137b1e5"><span class="done DONE">DONE</span> Describe Cart Sub implementations</a></li>
<li><a href="#orgd3cd7bd"><span class="done DONE">DONE</span> Add timing for primitives</a></li>
<li><a href="#orgd3f874e"><span class="done DONE">DONE</span> Remove unnecessary parts of code</a></li>
<li><a href="#org737ff12"><span class="todo TODO">TODO</span> Free memory</a></li>
<li><a href="#orgff203e1"><span class="todo HOLD">HOLD</span> Keep only the name in the communicator with Comm_set_attr</a></li>
<li><a href="#org9f4b536"><span class="done DONE">DONE</span> Cleanup code</a></li>
<li><a href="#org3616bcb"><span class="done DONE">DONE</span> How to add a new primitive</a></li>
<li><a href="#orgedc51b3"><span class="done DONE">DONE</span> Add Recv and Irecv operations</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org1f099ef" class="outline-2">
<h2 id="org1f099ef">Overview</h2>
<div class="outline-text-2" id="text-org1f099ef">
<p>
The main idea of this tool is to provide accurate information about the MPI Communicators via profiling with low overhead.
</p>
</div>
<div id="outline-container-org953fa4d" class="outline-3">
<h3 id="org953fa4d">Specifications</h3>
<div class="outline-text-3" id="text-org953fa4d">
<ol class="org-ol">
<li>Communicator related information (calls, tree)</li>
<li>Data traffic (Bytes sent) in every communicator</li>
<li>MPI communication primitives information in every communicator</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orge0b835a" class="outline-2">
<h2 id="orge0b835a">Installation</h2>
<div class="outline-text-2" id="text-orge0b835a">
</div>
<div id="outline-container-org687b05c" class="outline-3">
<h3 id="org687b05c">Dependencies</h3>
<div class="outline-text-3" id="text-org687b05c">
<ol class="org-ol">
<li>MPI version bla bla bla</li>
</ol>
</div>
</div>
<div id="outline-container-org7724104" class="outline-3">
<h3 id="org7724104">Compile</h3>
<div class="outline-text-3" id="text-org7724104">
<ol class="org-ol">
<li>Get the tool from here www.bla.org</li>
<li>Compile with bla</li>
</ol>
</div>
</div>
<div id="outline-container-orgdebac7e" class="outline-3">
<h3 id="orgdebac7e">Tests</h3>
<div class="outline-text-3" id="text-orgdebac7e">
<p>
Run the tests blablabla
</p>
</div>
</div>
</div>
<div id="outline-container-org585fb94" class="outline-2">
<h2 id="org585fb94">Usage</h2>
<div class="outline-text-2" id="text-org585fb94">
</div>
<div id="outline-container-org2ed840f" class="outline-3">
<h3 id="org2ed840f">Output</h3>
<div class="outline-text-3" id="text-org2ed840f">
<p>
Output file name &ldquo;profiler_data.csv&rdquo;. If this file exists it will be overwritten.
</p>
</div>
<div id="outline-container-org66ca6c8" class="outline-4">
<h4 id="org66ca6c8">Header</h4>
<div class="outline-text-4" id="text-org66ca6c8">
<ul class="org-ul">
<li>MPI Version and MPI Implementation</li>
<li>Application name and arguments</li>
<li>Number of processes</li>
<li>Machine Name of Process 0</li>
<li>Date of the Run</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org9714d01" class="outline-2">
<h2 id="org9714d01">Implementation</h2>
<div class="outline-text-2" id="text-org9714d01">
</div>
<div id="outline-container-org09acddf" class="outline-3">
<h3 id="org09acddf">Basic idea</h3>
<div class="outline-text-3" id="text-org09acddf">
<ul class="org-ul">
<li>Keep data for each communicator using <code>MPI_Comm_set_attr()</code>
<ul class="org-ul">
<li>This has worked so far but it has some issues with <code>MPI_Comm_free()</code></li>
<li>To solve these issues I have kept a local data structure with the communicators and their corresponding data
<ul class="org-ul">
<li>Since the data are <b>copied</b> in this local data structure <code>MPI_Comm_free()</code> is no longer an issue</li>
</ul></li>
</ul></li>
<li>Communicator name prefix includes its ancestor
<ul class="org-ul">
<li>The name includes an id that is the number of communicators</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgd3c7ddb" class="outline-3">
<h3 id="orgd3c7ddb">Supported Communicator Primitives</h3>
<div class="outline-text-3" id="text-orgd3c7ddb">
<ul class="org-ul">
<li>MPI_Comm_split</li>
<li>MPI_Comm_dup</li>
<li>MPI_Comm_create</li>
<li>MPI_Cart_create</li>
<li>MPI_Cart_sub</li>
</ul>
</div>
</div>
<div id="outline-container-org5d60768" class="outline-3">
<h3 id="org5d60768">Unsupported Communicator Primitives</h3>
<div class="outline-text-3" id="text-org5d60768">
<ul class="org-ul">
<li>MPI_Comm_create_group</li>
</ul>
</div>
</div>
<div id="outline-container-orgd52d58f" class="outline-3">
<h3 id="orgd52d58f"><span class="todo TODO">TODO</span> Supported Communicator Primitives</h3>
<div class="outline-text-3" id="text-orgd52d58f">
<ul class="org-ul">
<li>MPI_Graph_create</li>
<li>MPI_Dist_graph_create</li>
</ul>
</div>
</div>
<div id="outline-container-org6e10987" class="outline-3">
<h3 id="org6e10987"><span class="done DONE">DONE</span> Supported MPI Collective communication Primitives</h3>
<div class="outline-text-3" id="text-org6e10987">
<ul class="org-ul">
<li>MPI_Barrier</li>
<li>MPI_Ibarrier</li>
<li>MPI_Gatherv</li>
<li>MPI_Scatter</li>
<li>MPI_Scatterv</li>
</ul>
</div>
</div>
<div id="outline-container-org11ebab3" class="outline-3">
<h3 id="org11ebab3">Supported MPI Point to Point Primitives</h3>
<div class="outline-text-3" id="text-org11ebab3">
<ul class="org-ul">
<li>MPI_Send</li>
<li>MPI_Isend</li>
<li>MPI_Recv</li>
<li>MPI_Irecv</li>
<li>MPI_Sendrecv</li>
</ul>
</div>
</div>
<div id="outline-container-orga9f82f3" class="outline-3">
<h3 id="orga9f82f3">Other MPI calls</h3>
<div class="outline-text-3" id="text-orga9f82f3">
<ul class="org-ul">
<li>MPI_Wait</li>
<li>MPI_Waitall</li>
</ul>
</div>
</div>
<div id="outline-container-org488eb53" class="outline-3">
<h3 id="org488eb53">Communicator creator primitives profiling</h3>
<div class="outline-text-3" id="text-org488eb53">
<p>
The implementations of some of the communicator primitives is also included. I chose to present some of them just to give an idea of how this tool works.
</p>
</div>
<div id="outline-container-org0bdd72a" class="outline-4">
<h4 id="org0bdd72a">Profiling MPI_Comm_create</h4>
</div>
<div id="outline-container-orge018e45" class="outline-4">
<h4 id="orge018e45">Profiling MPI_Comm_split</h4>
<div class="outline-text-4" id="text-orge018e45">
<p>
Communicator suffix includes two distinct ids:
</p>
<ul class="org-ul">
<li>The first id denotes the current number of communicators among all processes</li>
<li>The second denotes the communicator after the split</li>
</ul>
<p>
There are two collective calls of <code>MPI_Allreduce()</code> in order to get the correct ids for the name. The first call synchronizes between the processes and get the maximum number. This way all processes agree on the first id of this communicator. Note that this call is done in the parent communicator. The second <code>MPI_Allreduce()</code> call is done in the newly created communicators where every processes sends its corresponding rank in the parent communicator and gets the minimum. This is allows the profiler to distinct between the newly created communicators. The second id of each of the new communicators is the minimum rank of the process in the parent communicator.
</p>
</div>
<ul class="org-ul">
<li><a id="org5ed56bd"></a>Code<br />
<div class="outline-text-5" id="text-org5ed56bd">
<div class="org-src-container">
<pre class="src src-c"><span style="color: #FCCE7B;">int</span>
<span style="color: #5cEfFF;">MPI_Init</span><span style="color: #51afef;">(</span><span style="color: #FCCE7B;">int</span> *<span style="color: #DFDFDF;">argc</span>, <span style="color: #FCCE7B;">char</span> ***<span style="color: #DFDFDF;">argv</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
    <span style="color: #51afef;">if</span> <span style="color: #C57BDB;">(</span> argc != <span style="color: #a991f1;">NULL</span>  <span style="color: #C57BDB;">)</span>
        getProcCmdLine <span style="color: #C57BDB;">(</span>&amp;ac, av<span style="color: #C57BDB;">)</span>;
    <span style="color: #51afef;">return</span> _MPI_Init<span style="color: #C57BDB;">(</span>argc, argv<span style="color: #C57BDB;">)</span>;
<span style="color: #51afef;">}</span>

<span style="color: #62686E;">/*</span>
<span style="color: #62686E;"> * The naming scheme for the MPI_Comm_create is done by collecting the</span>
<span style="color: #62686E;"> * maximum number of communicators from all processes and using it as id.</span>
<span style="color: #62686E;"> * Use parent communicator name as prefix</span>
<span style="color: #62686E;"> */</span>
<span style="color: #FCCE7B;">int</span>
<span style="color: #5cEfFF;">MPI_Comm_create</span><span style="color: #51afef;">(</span><span style="color: #FCCE7B;">MPI_Comm</span> <span style="color: #DFDFDF;">comm</span>, <span style="color: #FCCE7B;">MPI_Group</span> <span style="color: #DFDFDF;">group</span>, <span style="color: #FCCE7B;">MPI_Comm</span> *<span style="color: #DFDFDF;">newcomm</span><span style="color: #51afef;">)</span>
<span style="color: #51afef;">{</span>
    <span style="color: #FCCE7B;">int</span> <span style="color: #DFDFDF;">ret</span>;
    <span style="color: #FCCE7B;">int</span> <span style="color: #DFDFDF;">comms</span>;
    <span style="color: #FCCE7B;">char</span> *<span style="color: #DFDFDF;">buf</span>;
    <span style="color: #FCCE7B;">prof_attrs</span> *<span style="color: #DFDFDF;">communicator</span>;
    ret = PMPI_Comm_create<span style="color: #C57BDB;">(</span>comm, group, newcomm<span style="color: #C57BDB;">)</span>;
    <span style="color: #62686E;">/*</span>
<span style="color: #62686E;">     * Synchronize with other processess and get the maximum number</span>
<span style="color: #62686E;">     * of communicators to use it an id. This must be done in the</span>
<span style="color: #62686E;">     * parent communicator. Even if Comm_split fails for a process</span>
<span style="color: #62686E;">     * that process must call this Allreduce</span>
<span style="color: #62686E;">     */</span>
    PMPI_Allreduce<span style="color: #C57BDB;">(</span>&amp;my_coms, &amp;comms, <span style="color: #e69055; font-weight: bold;">1</span>, <span style="color: #a991f1;">MPI_INT</span>, <span style="color: #a991f1;">MPI_MAX</span>, comm<span style="color: #C57BDB;">)</span>;
    my_coms = comms;
    <span style="color: #51afef;">if</span> <span style="color: #C57BDB;">(</span> newcomm == <span style="color: #a991f1;">NULL</span> || *newcomm == <span style="color: #a991f1;">MPI_COMM_NULL</span> <span style="color: #C57BDB;">){</span>
        <span style="color: #51afef;">return</span> ret;
    <span style="color: #C57BDB;">}</span>
    <span style="color: #62686E;">/* </span><span style="color: #62686E;">Use the parent's name as a prefix for the newly created communicator</span><span style="color: #62686E;"> */</span>
    communicator = get_comm_parent<span style="color: #C57BDB;">(</span>comm<span style="color: #C57BDB;">)</span>;
    buf = <span style="color: #C57BDB;">(</span><span style="color: #FCCE7B;">char</span>*<span style="color: #C57BDB;">)</span> malloc <span style="color: #C57BDB;">(</span> <span style="color: #51afef;">sizeof</span><span style="color: #7bc275;">(</span><span style="color: #FCCE7B;">char</span><span style="color: #7bc275;">)</span>*<span style="color: #e69055; font-weight: bold;">8</span><span style="color: #C57BDB;">)</span>;
    <span style="color: #62686E;">/* </span><span style="color: #62686E;">Append prefix+suffix and initialize the data for the new communicator</span><span style="color: #62686E;"> */</span>
    sprintf<span style="color: #C57BDB;">(</span>buf,<span style="color: #7bc275;">"_c%d"</span>,my_coms<span style="color: #C57BDB;">)</span>;
    _new_comm<span style="color: #C57BDB;">(</span>buf, &amp;communicator, comm, newcomm<span style="color: #C57BDB;">)</span>;
    PMPI_Comm_set_attr<span style="color: #C57BDB;">(</span>*newcomm, namekey<span style="color: #7bc275;">()</span>, communicator<span style="color: #C57BDB;">)</span>;
    <span style="color: #51afef;">return</span> ret;
<span style="color: #51afef;">}</span>
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgdcd5bde" class="outline-2">
<h2 id="orgdcd5bde">Contribute</h2>
<div class="outline-text-2" id="text-orgdcd5bde">
</div>
<div id="outline-container-org638c8bc" class="outline-3">
<h3 id="org638c8bc">How to add a new primitive for profiling</h3>
<div class="outline-text-3" id="text-org638c8bc">
<ol class="org-ol">
<li>Increase the &ldquo;NUM_OF_PRIMS&rdquo; variable in <a href="../utils.c">../utils.c</a> file</li>
<li>Add the new primitive as enumerated type in <a href="file:///home/vardas/repos/communicator_profiler/utils.c">file:///home/vardas/repos/communicator_profiler/utils.c</a> file</li>
<li>Make sure that the enumerated type is the same with the char table &ldquo;prim_names&rdquo; in file <a href="file:///home/vardas/repos/communicator_profiler/utils.c">file:///home/vardas/repos/communicator_profiler/utils.c</a></li>
<li>Write the wrapper code in  <a href="file:///home/vardas/repos/communicator_profiler/commprof.c">file:///home/vardas/repos/communicator_profiler/commprof.c</a> - use the other functions as a template
<ol class="org-ol">
<li>Add the Fortran wrapper for intercepting Fortran code this is an issue with OpenMPI</li>
</ol></li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orga055119" class="outline-2">
<h2 id="orga055119">Future Work</h2>
<div class="outline-text-2" id="text-orga055119">
</div>
<div id="outline-container-org137b1e5" class="outline-3">
<h3 id="org137b1e5"><span class="done DONE">DONE</span> Describe Cart Sub implementations</h3>
</div>
<div id="outline-container-orgd3cd7bd" class="outline-3">
<h3 id="orgd3cd7bd"><span class="done DONE">DONE</span> Add timing for primitives</h3>
</div>
<div id="outline-container-orgd3f874e" class="outline-3">
<h3 id="orgd3f874e"><span class="done DONE">DONE</span> Remove unnecessary parts of code</h3>
</div>
<div id="outline-container-org737ff12" class="outline-3">
<h3 id="org737ff12"><span class="todo TODO">TODO</span> Free memory</h3>
</div>
<div id="outline-container-orgff203e1" class="outline-3">
<h3 id="orgff203e1"><span class="todo HOLD">HOLD</span> Keep only the name in the communicator with Comm_set_attr</h3>
</div>
<div id="outline-container-org9f4b536" class="outline-3">
<h3 id="org9f4b536"><span class="done DONE">DONE</span> Cleanup code</h3>
</div>
<div id="outline-container-org3616bcb" class="outline-3">
<h3 id="org3616bcb"><span class="done DONE">DONE</span> How to add a new primitive</h3>
</div>
<div id="outline-container-orgedc51b3" class="outline-3">
<h3 id="orgedc51b3"><span class="done DONE">DONE</span> Add Recv and Irecv operations</h3>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Ioannis Vardas</p>
<p class="date">Created: 2021-10-15 Fri 00:32</p>
</div>
</body>
</html>
