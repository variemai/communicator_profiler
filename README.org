#+TITLE: mpisee: a profiling tool for MPI communicators
#+OPTIONS: ^:nil num:nil

* Introduction
=mpisee= is a profiling tool for MPI that provides profiling data for the communicators of the MPI applications. To conveniently read the output of =mpisee= use =mpisee-through= script to post-processes the output file for quick summary information.
* Features
The tool provides the following data:
- For each communicator:
  - For each MPI call
    1. Time spent
    2. Volume
    3. Number of calls
- Additional data:
  1. Total time of every MPI rank
  2. Node mapping of every MPI rank
- Output in a csv file
- Post-processing with =mpisee-through=
* Build
1. ~CC=mpicc make~ to compile the profiling library, the shared object will be created in ~./lib~ folder.
** Dependencies
1. MPI library (openmpi,mpich) version $> 2$
2. gcc version that supports lto, otherwise disable lto flag in Makefile
*IMPORTANT*: Make sure that the application is compiled with the same MPI library as mpisee
* Usage
- Recommended: ~LD_PRELOAD=/path/to/mpisee/lib/libmpisee.so run <application>~
- You can also link your application with the =libmpisee.so= using the ~-L/path/to/mpisee/lib~ and ~-lmpisee~
  - To run with this add the ~/path/to/mpisee/lib~ to LD_LIBRARY_PATH
* Output
- The csv file consists of lines that start with '#', with '#@', and the rest of the data that start with the MPI rank number.
- Lines that start with '#' contain metadata information such as:
  - Profile date
  - MPI library version
  - Application and arguments
  - =mpisee= version
- Lines that start with '#@' contain information of how to read the data lines and some data information:
  - =#@mapping_l= Mapping of each process
  - =#@metric_l= denotes the type of metric used for the specific line ("VOL, TIME, NCALLS")
  - =#@metric_type_l= denotes the unit for this metric (float,int)
  - =#@comm_l= list of communicator names
  - =#@comm_sz_l= list of communicator sizes
  - =#@call_l= list of MPI calls
  - =#@rank_start_l= list of start timestamp for each rank
  - =#@rank_end_l= list of end timestamp for each rank
- Format of a data line:
  "Rank", "Comm", "Call", "Type", "Val"
  - Rank: the corresponding MPI ranks
  - Call: index to the MPI call list
  - Comm: index to the communicator list
  - Type: index to type of metric used
  - Val: index to unit of metric
